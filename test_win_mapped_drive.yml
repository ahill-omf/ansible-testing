---
- name: Test credential and win mapped drive
  hosts: all
  gather_facts: false
  vars:
    pass: !vault |
      $ANSIBLE_VAULT;1.1;AES256
      36373130653638303239636161363935633763346261613131306332306137656666376237363165
      3665313731316233363466366638653238363665643664640a383037633663303931396432656564
      31336665643338373939313231303534613330313235383861663262613233323934323539303066
      3932363431623138390a373037313832313437326365336333373134646562346232643434613964
      63303434316265333133363039333036313363633564633462613432623962303663
  tasks:
    - name: Print pass
      ansible.builtin.debug:
        var: pass
    - name: Create a mapped drive that requires authentication
      community.windows.win_mapped_drive:
        letter: M
        path: \\corp.fin\shared
        state: present
        username: t2222009-sva@CORP.FIN
        password: "{{ pass | string }}"
      become: true
      become_method: runas
      become_user: t2222009-sva@CORP.FIN
      become_password: "{{ pass | string }}"
